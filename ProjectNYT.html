<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
 

    <meta name="viewport" content="width=device-width,initial-scale=1">
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
    </head>
    <link rel="stylesheet" type="text/css" href="css/project.css">
    <style type="text/css"> 
     #foter {
    position: fixed;
    left: 0;
    bottom: 0;
    height: 70px;
    width: 100%;
    background-color: #734547;
    color: black;
    text-align: center;


  
}
.form-inline{
    text-align: left;
	position: fixed;
	left: 20px;
}
.details {
            float: left;
            width: 25%;
            background-color: darkorange;
            color: white;
            font-weight: bold;
        }
</style>
    <body>
         <header>
       <h1>NYT Explorer</h1>
      <hr/>
    </header>
       
     
            
            <form id="center">
              <div class="form-inline">
               
              
              <input id="month" type="number" min="1" max="12" value="1" placeholder="Enter month" required> 
              <input id="year" type="number" min="1851" max="2018" value="1851" placeholder="Enter year" required>
                <button onclick="find()">Find</button></form>
            </div>
                   <div id="root"></div>
                   <div id="container" class='flex'>
                   
                   </div>
                   <footer id ="foter">
                     <hr/>
      <p>Data provided by NY Times API</p>
                    <p>Links preview by Link Preview API</p>
      <p>&copy; Jovan Pranic 2018</p>
                   </footer>

      <script type="text/babel">

      	class Link extends React.Component {

      	constructor(props){
      	super(props);
      	this.state={ data:[],
        selectedLink : {description : "something"}};
      	this.setData=this.setData.bind(this);
        this.onMouseOver = this.onMouseOver.bind(this);
      }

      onMousOver(link){

      this.setState({selectedLink: link})
    }
      setData(call){

     

      const links=call.response.docs.slice(o,4);
      
      this.setState({ data: call});
  }

      componentDidMount(){
            $.ajax({
                url:"https://api.nytimes.com/svc/archive/v1/2016/1.json",
                method: "GET",
                data:{
                "api-key": "603fd44d05be4c86abc3b8531459b25d"},
                
                
                success: this.setData
         })
     }


      render(){

      console.log("render");

   

      return (
                    <div className="page">
                        <div className="master">
                            <Table
                                selectionHandler={this.onMousOver} 
                                data={this.state.data}/>
                        </div>
                        <div className="details">
                            
                             <LinkDetails Link={this.state.selectedLink}/>
                        </div>
                    </div>
                );
            }

        }
	
const LinkDetails=(props)=>{
  
  const Link=props.Link;

  console.log(Link);


  return(
  <div><p> Article Preview:</p>
    <ul>
      <li> {Link.source}</li>
      <li>{Link.section_name}</li>
       <li> {Link.pub_date}</li>
       <li> {Link.snippet}</li>
       <li>URL:<a href= {Link.web_url}>{Link.web_url}</a></li> 
                       
                        
                    </ul>

    


  </div>



  );
}



class Preview extends React.Component {
  
render(){
  const links=this.props.data;
  if(links.length==0){

  return ( <P>something<P>; 
}
<div> {
  this.props.data.map( (article) => <Article link={article} key={article.web_url} url={article.web_url} mousOverHeandler={this.props.selectionHandler}/> )
}



class Article extends React.Component {

constructor(props){


super(props)
this.state={data:[]};
this.onSuccess=this.onSuccess.bind(this);
      }
      onSuccess(call){

     

      const links=call.response.docs[i];
      
      this.setState({data: call);

}
  

}

 
 componentDidMount(){
    $.ajax({
    url: https://www.linkpreview.net/
    method: "GET",
    data : {
    api-key: 'key': " 5a9158a7b416741792dd7ae022541678a701bcd5efc59", 
          'q': 'https://www.google.com' 
    },
    success : this.onSuccess

    });
        
    }}

    render(){

    const Link = this.props.link;
    const mousOverHeandler=this.props.mousOverHeandler;
    return(

        <div onmousemove={()=>mousOverHeandler(Link)}>
          <p>{this.state.data.title}</p>
          <img src={this.state.data.image} alt="PIP"/>
          <p>{this.state.data.description}</p></div>
         );
      }



  }

function find(){
        const root = document.getElementById('root');
        ReactDOM.render(<Link />,  root);




  



            </script>
        </body>
        </html>